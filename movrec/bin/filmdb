#!/bin/bash
# searchdb
# Stop on errors
# See https://vaneyckt.io/posts/safer_bash_scripts_with_set_euxo_pipefail/
set -Eeuo pipefail
# Sanity check command line options
usage() {
  echo "Usage: $0 (create|destroy|reset)"
}
if [ $# -ne 1 ]; then
  usage
  exit 1
fi

create () {
	# Avoid clobbering an existing database
	if [ -f "var/film.sqlite3" ]
	then
		echo "Error: database already exists"
		exit 1
	fi
  mkdir -p var/
  sqlite3 var/film.sqlite3 < front_server/front/sql/film.sql
}

destroy () {
	rm -f var/film.sqlite3
}

reset () {
	# Equivalent to destroy then create
	destroy
	create
}

# Parse argument.  $1 is the first argument
case $1 in
        "create")
            create
            ;;
        "destroy")
            destroy
            ;;
        "reset")
            reset
            ;;
          *)
    usage
    exit 1
    ;;
esac